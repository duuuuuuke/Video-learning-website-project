<!DOCTYPE html>
<html>
<head>
  <title>DB_forge.php</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../doc-style.css" />
  <script src="../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../";
    var thisFile = "src\\myapp\\system\\database\\DB_forge.php";
    var defaultSidebar = true;
  </script>
  <script src="../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>DB_forge.php</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="php"><span class="hljs-meta">&lt;?php</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>CodeIgniter</p>
</div>
<div class="body">
<p>An open source application development framework for PHP</p>
<p>This content is released under the MIT License (MIT)</p>
<p>Copyright (c) 2014 - 2019, British Columbia Institute of Technology</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &quot;Software&quot;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.</p>
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">defined(<span class="hljs-string">'BASEPATH'</span>) <span class="hljs-keyword">OR</span> <span class="hljs-keyword">exit</span>(<span class="hljs-string">'No direct script access allowed'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<div class="dox">
<div class="summary">
<p>Database Forge Class</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php"><span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CI_DB_forge</span> </span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<div class="dox">
<div class="summary">
<p>Database object</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $db;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<div class="dox">
<div class="summary">
<p>Fields data</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> $fields		= <span class="hljs-keyword">array</span>();

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<div class="dox">
<div class="summary">
<p>Keys data</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> $keys		= <span class="hljs-keyword">array</span>();

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<div class="dox">
<div class="summary">
<p>Primary Keys data</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> $primary_keys	= <span class="hljs-keyword">array</span>();

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<div class="dox">
<div class="summary">
<p>Database character set</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> $db_char_set	= <span class="hljs-string">''</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<div class="dox">
<div class="summary">
<p>CREATE DATABASE statement</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_create_database	= <span class="hljs-string">'CREATE DATABASE %s'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<div class="dox">
<div class="summary">
<p>DROP DATABASE statement</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_drop_database	= <span class="hljs-string">'DROP DATABASE %s'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<div class="dox">
<div class="summary">
<p>CREATE TABLE statement</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_create_table	= <span class="hljs-string">"%s %s (%s\n)"</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
<p>CREATE TABLE IF statement</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_create_table_if	= <span class="hljs-string">'CREATE TABLE IF NOT EXISTS'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<div class="dox">
<div class="summary">
<p>CREATE TABLE keys flag</p>
</div>
<div class="body">
<p>Whether table keys are created from within the
CREATE TABLE statement.</p>
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_create_table_keys	= <span class="hljs-keyword">FALSE</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<div class="dox">
<div class="summary">
<p>DROP TABLE IF EXISTS statement</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_drop_table_if	= <span class="hljs-string">'DROP TABLE IF EXISTS'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<div class="dox">
<div class="summary">
<p>RENAME TABLE statement</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_rename_table	= <span class="hljs-string">'ALTER TABLE %s RENAME TO %s;'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<div class="dox">
<div class="summary">
<p>UNSIGNED support</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_unsigned		= <span class="hljs-keyword">TRUE</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<div class="dox">
<div class="summary">
<p>NULL value representation in CREATE/ALTER TABLE statements</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_null		= <span class="hljs-string">''</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<div class="dox">
<div class="summary">
<p>DEFAULT value representation in CREATE/ALTER TABLE statements</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> $_default		= <span class="hljs-string">' DEFAULT '</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<div class="dox">
<div class="summary">
<p>Class constructor</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">object</span>
<span>&amp;$db Database object
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>void
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(&amp;$db)</span>
	</span>{
		<span class="hljs-keyword">$this</span>-&gt;db =&amp; $db;
		log_message(<span class="hljs-string">'info'</span>, <span class="hljs-string">'Database Forge Class Initialized'</span>);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<div class="dox">
<div class="summary">
<p>Create database</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$db_name
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>bool
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create_database</span><span class="hljs-params">($db_name)</span>
	</span>{
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;_create_database === <span class="hljs-keyword">FALSE</span>)
		{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_unsupported_feature'</span>) : <span class="hljs-keyword">FALSE</span>;
		}
		<span class="hljs-keyword">elseif</span> ( ! <span class="hljs-keyword">$this</span>-&gt;db-&gt;query(sprintf(<span class="hljs-keyword">$this</span>-&gt;_create_database, <span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($db_name), <span class="hljs-keyword">$this</span>-&gt;db-&gt;char_set, <span class="hljs-keyword">$this</span>-&gt;db-&gt;dbcollat)))
		{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_unable_to_drop'</span>) : <span class="hljs-keyword">FALSE</span>;
		}

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">empty</span>(<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'db_names'</span>]))
		{
			<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'db_names'</span>][] = $db_name;
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">TRUE</span>;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<div class="dox">
<div class="summary">
<p>Drop database</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$db_name
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>bool
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drop_database</span><span class="hljs-params">($db_name)</span>
	</span>{
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;_drop_database === <span class="hljs-keyword">FALSE</span>)
		{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_unsupported_feature'</span>) : <span class="hljs-keyword">FALSE</span>;
		}
		<span class="hljs-keyword">elseif</span> ( ! <span class="hljs-keyword">$this</span>-&gt;db-&gt;query(sprintf(<span class="hljs-keyword">$this</span>-&gt;_drop_database, <span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($db_name))))
		{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_unable_to_drop'</span>) : <span class="hljs-keyword">FALSE</span>;
		}

		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">empty</span>(<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'db_names'</span>]))
		{
			$key = array_search(strtolower($db_name), array_map(<span class="hljs-string">'strtolower'</span>, <span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'db_names'</span>]), <span class="hljs-keyword">TRUE</span>);
			<span class="hljs-keyword">if</span> ($key !== <span class="hljs-keyword">FALSE</span>)
			{
				<span class="hljs-keyword">unset</span>(<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'db_names'</span>][$key]);
			}
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">TRUE</span>;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<div class="dox">
<div class="summary">
<p>Add Key</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$key
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">bool</span>
<span>$primary
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>CI_DB_forge
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add_key</span><span class="hljs-params">($key, $primary = FALSE)</span>
	</span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>DO NOT change this! This condition is only applicable
for PRIMARY keys because you can only have one such,
and therefore all fields you add to it will be included
in the same, composite PRIMARY KEY.</p>
<p>It's not the same for regular indexes.</p>

        </td>
        <td class="code highlight">
          <pre class="php">		<span class="hljs-keyword">if</span> ($primary === <span class="hljs-keyword">TRUE</span> &amp;&amp; is_array($key))
		{
			<span class="hljs-keyword">foreach</span> ($key <span class="hljs-keyword">as</span> $one)
			{
				<span class="hljs-keyword">$this</span>-&gt;add_key($one, $primary);
			}

			<span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;
		}

		<span class="hljs-keyword">if</span> ($primary === <span class="hljs-keyword">TRUE</span>)
		{
			<span class="hljs-keyword">$this</span>-&gt;primary_keys[] = $key;
		}
		<span class="hljs-keyword">else</span>
		{
			<span class="hljs-keyword">$this</span>-&gt;keys[] = $key;
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<div class="dox">
<div class="summary">
<p>Add Field</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>$field
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>CI_DB_forge
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add_field</span><span class="hljs-params">($field)</span>
	</span>{
		<span class="hljs-keyword">if</span> (is_string($field))
		{
			<span class="hljs-keyword">if</span> ($field === <span class="hljs-string">'id'</span>)
			{
				<span class="hljs-keyword">$this</span>-&gt;add_field(<span class="hljs-keyword">array</span>(
					<span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">array</span>(
						<span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'INT'</span>,
						<span class="hljs-string">'constraint'</span> =&gt; <span class="hljs-number">9</span>,
						<span class="hljs-string">'auto_increment'</span> =&gt; <span class="hljs-keyword">TRUE</span>
					)
				));
				<span class="hljs-keyword">$this</span>-&gt;add_key(<span class="hljs-string">'id'</span>, <span class="hljs-keyword">TRUE</span>);
			}
			<span class="hljs-keyword">else</span>
			{
				<span class="hljs-keyword">if</span> (strpos($field, <span class="hljs-string">' '</span>) === <span class="hljs-keyword">FALSE</span>)
				{
					show_error(<span class="hljs-string">'Field information is required for that operation.'</span>);
				}

				<span class="hljs-keyword">$this</span>-&gt;fields[] = $field;
			}
		}

		<span class="hljs-keyword">if</span> (is_array($field))
		{
			<span class="hljs-keyword">$this</span>-&gt;fields = array_merge(<span class="hljs-keyword">$this</span>-&gt;fields, $field);
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<div class="dox">
<div class="summary">
<p>Create Table</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table Table name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">bool</span>
<span>$if_not_exists Whether to add IF NOT EXISTS condition
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>$attributes Associative array of table attributes
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>bool
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create_table</span><span class="hljs-params">($table, $if_not_exists = FALSE, array $attributes = array<span class="hljs-params">()</span>)</span>
	</span>{
		<span class="hljs-keyword">if</span> ($table === <span class="hljs-string">''</span>)
		{
			show_error(<span class="hljs-string">'A table name is required for that operation.'</span>);
		}
		<span class="hljs-keyword">else</span>
		{
			$table = <span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$table;
		}

		<span class="hljs-keyword">if</span> (count(<span class="hljs-keyword">$this</span>-&gt;fields) === <span class="hljs-number">0</span>)
		{
			show_error(<span class="hljs-string">'Field information is required.'</span>);
		}

		$sql = <span class="hljs-keyword">$this</span>-&gt;_create_table($table, $if_not_exists, $attributes);

		<span class="hljs-keyword">if</span> (is_bool($sql))
		{
			<span class="hljs-keyword">$this</span>-&gt;_reset();
			<span class="hljs-keyword">if</span> ($sql === <span class="hljs-keyword">FALSE</span>)
			{
				<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_unsupported_feature'</span>) : <span class="hljs-keyword">FALSE</span>;
			}
		}

		<span class="hljs-keyword">if</span> (($result = <span class="hljs-keyword">$this</span>-&gt;db-&gt;query($sql)) !== <span class="hljs-keyword">FALSE</span>)
		{
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'table_names'</span>]))
			{
				<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'table_names'</span>][] = $table;
			}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<p>Most databases don't support creating indexes from within the CREATE TABLE statement</p>

        </td>
        <td class="code highlight">
          <pre class="php">			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">empty</span>(<span class="hljs-keyword">$this</span>-&gt;keys))
			{
				<span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>, $sqls = <span class="hljs-keyword">$this</span>-&gt;_process_indexes($table), $c = count($sqls); $i &lt; $c; $i++)
				{
					<span class="hljs-keyword">$this</span>-&gt;db-&gt;query($sqls[$i]);
				}
			}
		}

		<span class="hljs-keyword">$this</span>-&gt;_reset();
		<span class="hljs-keyword">return</span> $result;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<div class="dox">
<div class="summary">
<p>Create Table</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table Table name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">bool</span>
<span>$if_not_exists Whether to add 'IF NOT EXISTS' condition
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>$attributes Associative array of table attributes
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>mixed
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_create_table</span><span class="hljs-params">($table, $if_not_exists, $attributes)</span>
	</span>{
		<span class="hljs-keyword">if</span> ($if_not_exists === <span class="hljs-keyword">TRUE</span> &amp;&amp; <span class="hljs-keyword">$this</span>-&gt;_create_table_if === <span class="hljs-keyword">FALSE</span>)
		{
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;table_exists($table))
			{
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">TRUE</span>;
			}

			$if_not_exists = <span class="hljs-keyword">FALSE</span>;
		}

		$sql = ($if_not_exists)
			? sprintf(<span class="hljs-keyword">$this</span>-&gt;_create_table_if, <span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($table))
			: <span class="hljs-string">'CREATE TABLE'</span>;

		$columns = <span class="hljs-keyword">$this</span>-&gt;_process_fields(<span class="hljs-keyword">TRUE</span>);
		<span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>, $c = count($columns); $i &lt; $c; $i++)
		{
			$columns[$i] = ($columns[$i][<span class="hljs-string">'_literal'</span>] !== <span class="hljs-keyword">FALSE</span>)
					? <span class="hljs-string">"\n\t"</span>.$columns[$i][<span class="hljs-string">'_literal'</span>]
					: <span class="hljs-string">"\n\t"</span>.<span class="hljs-keyword">$this</span>-&gt;_process_column($columns[$i]);
		}

		$columns = implode(<span class="hljs-string">','</span>, $columns)
				.<span class="hljs-keyword">$this</span>-&gt;_process_primary_keys($table);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<p>Are indexes created from within the CREATE TABLE statement? (e.g. in MySQL)</p>

        </td>
        <td class="code highlight">
          <pre class="php">		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;_create_table_keys === <span class="hljs-keyword">TRUE</span>)
		{
			$columns .= <span class="hljs-keyword">$this</span>-&gt;_process_indexes($table);
		}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<p>_create_table will usually have the following format: &quot;%s %s (%s\n)&quot;</p>

        </td>
        <td class="code highlight">
          <pre class="php">		$sql = sprintf(<span class="hljs-keyword">$this</span>-&gt;_create_table.<span class="hljs-string">'%s'</span>,
			$sql,
			<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($table),
			$columns,
			<span class="hljs-keyword">$this</span>-&gt;_create_table_attr($attributes)
		);

		<span class="hljs-keyword">return</span> $sql;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39"></a>
</div>
<div class="dox">
<div class="summary">
<p>CREATE TABLE attributes</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>$attributes Associative array of table attributes
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>string
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_create_table_attr</span><span class="hljs-params">($attributes)</span>
	</span>{
		$sql = <span class="hljs-string">''</span>;

		<span class="hljs-keyword">foreach</span> (array_keys($attributes) <span class="hljs-keyword">as</span> $key)
		{
			<span class="hljs-keyword">if</span> (is_string($key))
			{
				$sql .= <span class="hljs-string">' '</span>.strtoupper($key).<span class="hljs-string">' '</span>.$attributes[$key];
			}
		}

		<span class="hljs-keyword">return</span> $sql;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41"></a>
</div>
<div class="dox">
<div class="summary">
<p>Drop Table</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table_name Table name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">bool</span>
<span>$if_exists Whether to add an IF EXISTS condition
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>bool
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drop_table</span><span class="hljs-params">($table_name, $if_exists = FALSE)</span>
	</span>{
		<span class="hljs-keyword">if</span> ($table_name === <span class="hljs-string">''</span>)
		{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_table_name_required'</span>) : <span class="hljs-keyword">FALSE</span>;
		}

		<span class="hljs-keyword">if</span> (($query = <span class="hljs-keyword">$this</span>-&gt;_drop_table(<span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$table_name, $if_exists)) === <span class="hljs-keyword">TRUE</span>)
		{
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">TRUE</span>;
		}

		$query = <span class="hljs-keyword">$this</span>-&gt;db-&gt;query($query);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42"></a>
</div>
<p>Update table list cache</p>

        </td>
        <td class="code highlight">
          <pre class="php">		<span class="hljs-keyword">if</span> ($query &amp;&amp; ! <span class="hljs-keyword">empty</span>(<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'table_names'</span>]))
		{
			$key = array_search(strtolower(<span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$table_name), array_map(<span class="hljs-string">'strtolower'</span>, <span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'table_names'</span>]), <span class="hljs-keyword">TRUE</span>);
			<span class="hljs-keyword">if</span> ($key !== <span class="hljs-keyword">FALSE</span>)
			{
				<span class="hljs-keyword">unset</span>(<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'table_names'</span>][$key]);
			}
		}

		<span class="hljs-keyword">return</span> $query;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44"></a>
</div>
<div class="dox">
<div class="summary">
<p>Drop Table</p>
</div>
<div class="body">
<p>Generates a platform-specific DROP TABLE string</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table Table name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">bool</span>
<span>$if_exists Whether to add an IF EXISTS condition
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>mixed (Returns a platform-specific DROP table string, or TRUE to indicate there's nothing to do)
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_drop_table</span><span class="hljs-params">($table, $if_exists)</span>
	</span>{
		$sql = <span class="hljs-string">'DROP TABLE'</span>;

		<span class="hljs-keyword">if</span> ($if_exists)
		{
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;_drop_table_if === <span class="hljs-keyword">FALSE</span>)
			{
				<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">$this</span>-&gt;db-&gt;table_exists($table))
				{
					<span class="hljs-keyword">return</span> <span class="hljs-keyword">TRUE</span>;
				}
			}
			<span class="hljs-keyword">else</span>
			{
				$sql = sprintf(<span class="hljs-keyword">$this</span>-&gt;_drop_table_if, <span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($table));
			}
		}

		<span class="hljs-keyword">return</span> $sql.<span class="hljs-string">' '</span>.<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($table);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46"></a>
</div>
<div class="dox">
<div class="summary">
<p>Rename Table</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table_name Old table name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$new_table_name New table name
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>bool
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rename_table</span><span class="hljs-params">($table_name, $new_table_name)</span>
	</span>{
		<span class="hljs-keyword">if</span> ($table_name === <span class="hljs-string">''</span> <span class="hljs-keyword">OR</span> $new_table_name === <span class="hljs-string">''</span>)
		{
			show_error(<span class="hljs-string">'A table name is required for that operation.'</span>);
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">FALSE</span>;
		}
		<span class="hljs-keyword">elseif</span> (<span class="hljs-keyword">$this</span>-&gt;_rename_table === <span class="hljs-keyword">FALSE</span>)
		{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_unsupported_feature'</span>) : <span class="hljs-keyword">FALSE</span>;
		}

		$result = <span class="hljs-keyword">$this</span>-&gt;db-&gt;query(sprintf(<span class="hljs-keyword">$this</span>-&gt;_rename_table,
						<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers(<span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$table_name),
						<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers(<span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$new_table_name))
					);

		<span class="hljs-keyword">if</span> ($result &amp;&amp; ! <span class="hljs-keyword">empty</span>(<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'table_names'</span>]))
		{
			$key = array_search(strtolower(<span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$table_name), array_map(<span class="hljs-string">'strtolower'</span>, <span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'table_names'</span>]), <span class="hljs-keyword">TRUE</span>);
			<span class="hljs-keyword">if</span> ($key !== <span class="hljs-keyword">FALSE</span>)
			{
				<span class="hljs-keyword">$this</span>-&gt;db-&gt;data_cache[<span class="hljs-string">'table_names'</span>][$key] = <span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$new_table_name;
			}
		}

		<span class="hljs-keyword">return</span> $result;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48"></a>
</div>
<div class="dox">
<div class="summary">
<p>Column Add</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table Table name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>$field Column definition
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$_after Column for AFTER clause (deprecated)
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>bool
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add_column</span><span class="hljs-params">($table, $field, $_after = NULL)</span>
	</span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49"></a>
</div>
<p>Work-around for literal column definitions</p>

        </td>
        <td class="code highlight">
          <pre class="php">		is_array($field) <span class="hljs-keyword">OR</span> $field = <span class="hljs-keyword">array</span>($field);

		<span class="hljs-keyword">foreach</span> (array_keys($field) <span class="hljs-keyword">as</span> $k)
		{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50"></a>
</div>
<p>Backwards-compatibility work-around for MySQL/CUBRID AFTER clause (remove in 3.1+)</p>

        </td>
        <td class="code highlight">
          <pre class="php">			<span class="hljs-keyword">if</span> ($_after !== <span class="hljs-keyword">NULL</span> &amp;&amp; is_array($field[$k]) &amp;&amp; ! <span class="hljs-keyword">isset</span>($field[$k][<span class="hljs-string">'after'</span>]))
			{
				$field[$k][<span class="hljs-string">'after'</span>] = $_after;
			}

			<span class="hljs-keyword">$this</span>-&gt;add_field(<span class="hljs-keyword">array</span>($k =&gt; $field[$k]));
		}

		$sqls = <span class="hljs-keyword">$this</span>-&gt;_alter_table(<span class="hljs-string">'ADD'</span>, <span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$table, <span class="hljs-keyword">$this</span>-&gt;_process_fields());
		<span class="hljs-keyword">$this</span>-&gt;_reset();
		<span class="hljs-keyword">if</span> ($sqls === <span class="hljs-keyword">FALSE</span>)
		{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_unsupported_feature'</span>) : <span class="hljs-keyword">FALSE</span>;
		}

		<span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>, $c = count($sqls); $i &lt; $c; $i++)
		{
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;query($sqls[$i]) === <span class="hljs-keyword">FALSE</span>)
			{
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">FALSE</span>;
			}
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">TRUE</span>;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52"></a>
</div>
<div class="dox">
<div class="summary">
<p>Column Drop</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table Table name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$column_name Column name
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>bool
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drop_column</span><span class="hljs-params">($table, $column_name)</span>
	</span>{
		$sql = <span class="hljs-keyword">$this</span>-&gt;_alter_table(<span class="hljs-string">'DROP'</span>, <span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$table, $column_name);
		<span class="hljs-keyword">if</span> ($sql === <span class="hljs-keyword">FALSE</span>)
		{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_unsupported_feature'</span>) : <span class="hljs-keyword">FALSE</span>;
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;db-&gt;query($sql);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54"></a>
</div>
<div class="dox">
<div class="summary">
<p>Column Modify</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table Table name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$field Column definition
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>bool
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">modify_column</span><span class="hljs-params">($table, $field)</span>
	</span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55"></a>
</div>
<p>Work-around for literal column definitions</p>

        </td>
        <td class="code highlight">
          <pre class="php">		is_array($field) <span class="hljs-keyword">OR</span> $field = <span class="hljs-keyword">array</span>($field);

		<span class="hljs-keyword">foreach</span> (array_keys($field) <span class="hljs-keyword">as</span> $k)
		{
			<span class="hljs-keyword">$this</span>-&gt;add_field(<span class="hljs-keyword">array</span>($k =&gt; $field[$k]));
		}

		<span class="hljs-keyword">if</span> (count(<span class="hljs-keyword">$this</span>-&gt;fields) === <span class="hljs-number">0</span>)
		{
			show_error(<span class="hljs-string">'Field information is required.'</span>);
		}

		$sqls = <span class="hljs-keyword">$this</span>-&gt;_alter_table(<span class="hljs-string">'CHANGE'</span>, <span class="hljs-keyword">$this</span>-&gt;db-&gt;dbprefix.$table, <span class="hljs-keyword">$this</span>-&gt;_process_fields());
		<span class="hljs-keyword">$this</span>-&gt;_reset();
		<span class="hljs-keyword">if</span> ($sqls === <span class="hljs-keyword">FALSE</span>)
		{
			<span class="hljs-keyword">return</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;db_debug) ? <span class="hljs-keyword">$this</span>-&gt;db-&gt;display_error(<span class="hljs-string">'db_unsupported_feature'</span>) : <span class="hljs-keyword">FALSE</span>;
		}

		<span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>, $c = count($sqls); $i &lt; $c; $i++)
		{
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;db-&gt;query($sqls[$i]) === <span class="hljs-keyword">FALSE</span>)
			{
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">FALSE</span>;
			}
		}

		<span class="hljs-keyword">return</span> <span class="hljs-keyword">TRUE</span>;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57"></a>
</div>
<div class="dox">
<div class="summary">
<p>ALTER TABLE</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$alter_type ALTER type
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table Table name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">mixed</span>
<span>$field Column definition
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>string|string[]
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_alter_table</span><span class="hljs-params">($alter_type, $table, $field)</span>
	</span>{
		$sql = <span class="hljs-string">'ALTER TABLE '</span>.<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($table).<span class="hljs-string">' '</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58"></a>
</div>
<p>DROP has everything it needs now.</p>

        </td>
        <td class="code highlight">
          <pre class="php">		<span class="hljs-keyword">if</span> ($alter_type === <span class="hljs-string">'DROP'</span>)
		{
			<span class="hljs-keyword">return</span> $sql.<span class="hljs-string">'DROP COLUMN '</span>.<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($field);
		}

		$sql .= ($alter_type === <span class="hljs-string">'ADD'</span>)
			? <span class="hljs-string">'ADD '</span>
			: $alter_type.<span class="hljs-string">' COLUMN '</span>;

		$sqls = <span class="hljs-keyword">array</span>();
		<span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>, $c = count($field); $i &lt; $c; $i++)
		{
			$sqls[] = $sql
				.($field[$i][<span class="hljs-string">'_literal'</span>] !== <span class="hljs-keyword">FALSE</span> ? $field[$i][<span class="hljs-string">'_literal'</span>] : <span class="hljs-keyword">$this</span>-&gt;_process_column($field[$i]));
		}

		<span class="hljs-keyword">return</span> $sqls;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-59" id="section-59"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60"></a>
</div>
<div class="dox">
<div class="summary">
<p>Process fields</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">bool</span>
<span>$create_table
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>array
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_process_fields</span><span class="hljs-params">($create_table = FALSE)</span>
	</span>{
		$fields = <span class="hljs-keyword">array</span>();

		<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;fields <span class="hljs-keyword">as</span> $key =&gt; $attributes)
		{
			<span class="hljs-keyword">if</span> (is_int($key) &amp;&amp; ! is_array($attributes))
			{
				$fields[] = <span class="hljs-keyword">array</span>(<span class="hljs-string">'_literal'</span> =&gt; $attributes);
				<span class="hljs-keyword">continue</span>;
			}

			$attributes = array_change_key_case($attributes, CASE_UPPER);

			<span class="hljs-keyword">if</span> ($create_table === <span class="hljs-keyword">TRUE</span> &amp;&amp; <span class="hljs-keyword">empty</span>($attributes[<span class="hljs-string">'TYPE'</span>]))
			{
				<span class="hljs-keyword">continue</span>;
			}

			<span class="hljs-keyword">isset</span>($attributes[<span class="hljs-string">'TYPE'</span>]) &amp;&amp; <span class="hljs-keyword">$this</span>-&gt;_attr_type($attributes);

			$field = <span class="hljs-keyword">array</span>(
				<span class="hljs-string">'name'</span>			=&gt; $key,
				<span class="hljs-string">'new_name'</span>		=&gt; <span class="hljs-keyword">isset</span>($attributes[<span class="hljs-string">'NAME'</span>]) ? $attributes[<span class="hljs-string">'NAME'</span>] : <span class="hljs-keyword">NULL</span>,
				<span class="hljs-string">'type'</span>			=&gt; <span class="hljs-keyword">isset</span>($attributes[<span class="hljs-string">'TYPE'</span>]) ? $attributes[<span class="hljs-string">'TYPE'</span>] : <span class="hljs-keyword">NULL</span>,
				<span class="hljs-string">'length'</span>		=&gt; <span class="hljs-string">''</span>,
				<span class="hljs-string">'unsigned'</span>		=&gt; <span class="hljs-string">''</span>,
				<span class="hljs-string">'null'</span>			=&gt; <span class="hljs-keyword">NULL</span>,
				<span class="hljs-string">'unique'</span>		=&gt; <span class="hljs-string">''</span>,
				<span class="hljs-string">'default'</span>		=&gt; <span class="hljs-string">''</span>,
				<span class="hljs-string">'auto_increment'</span>	=&gt; <span class="hljs-string">''</span>,
				<span class="hljs-string">'_literal'</span>		=&gt; <span class="hljs-keyword">FALSE</span>
			);

			<span class="hljs-keyword">isset</span>($attributes[<span class="hljs-string">'TYPE'</span>]) &amp;&amp; <span class="hljs-keyword">$this</span>-&gt;_attr_unsigned($attributes, $field);

			<span class="hljs-keyword">if</span> ($create_table === <span class="hljs-keyword">FALSE</span>)
			{
				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($attributes[<span class="hljs-string">'AFTER'</span>]))
				{
					$field[<span class="hljs-string">'after'</span>] = $attributes[<span class="hljs-string">'AFTER'</span>];
				}
				<span class="hljs-keyword">elseif</span> (<span class="hljs-keyword">isset</span>($attributes[<span class="hljs-string">'FIRST'</span>]))
				{
					$field[<span class="hljs-string">'first'</span>] = (bool) $attributes[<span class="hljs-string">'FIRST'</span>];
				}
			}

			<span class="hljs-keyword">$this</span>-&gt;_attr_default($attributes, $field);

			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($attributes[<span class="hljs-string">'NULL'</span>]))
			{
				<span class="hljs-keyword">if</span> ($attributes[<span class="hljs-string">'NULL'</span>] === <span class="hljs-keyword">TRUE</span>)
				{
					$field[<span class="hljs-string">'null'</span>] = <span class="hljs-keyword">empty</span>(<span class="hljs-keyword">$this</span>-&gt;_null) ? <span class="hljs-string">''</span> : <span class="hljs-string">' '</span>.<span class="hljs-keyword">$this</span>-&gt;_null;
				}
				<span class="hljs-keyword">else</span>
				{
					$field[<span class="hljs-string">'null'</span>] = <span class="hljs-string">' NOT NULL'</span>;
				}
			}
			<span class="hljs-keyword">elseif</span> ($create_table === <span class="hljs-keyword">TRUE</span>)
			{
				$field[<span class="hljs-string">'null'</span>] = <span class="hljs-string">' NOT NULL'</span>;
			}

			<span class="hljs-keyword">$this</span>-&gt;_attr_auto_increment($attributes, $field);
			<span class="hljs-keyword">$this</span>-&gt;_attr_unique($attributes, $field);

			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($attributes[<span class="hljs-string">'COMMENT'</span>]))
			{
				$field[<span class="hljs-string">'comment'</span>] = <span class="hljs-keyword">$this</span>-&gt;db-&gt;escape($attributes[<span class="hljs-string">'COMMENT'</span>]);
			}

			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($attributes[<span class="hljs-string">'TYPE'</span>]) &amp;&amp; ! <span class="hljs-keyword">empty</span>($attributes[<span class="hljs-string">'CONSTRAINT'</span>]))
			{
				<span class="hljs-keyword">switch</span> (strtoupper($attributes[<span class="hljs-string">'TYPE'</span>]))
				{
					<span class="hljs-keyword">case</span> <span class="hljs-string">'ENUM'</span>:
					<span class="hljs-keyword">case</span> <span class="hljs-string">'SET'</span>:
						$attributes[<span class="hljs-string">'CONSTRAINT'</span>] = <span class="hljs-keyword">$this</span>-&gt;db-&gt;escape($attributes[<span class="hljs-string">'CONSTRAINT'</span>]);
					<span class="hljs-keyword">default</span>:
						$field[<span class="hljs-string">'length'</span>] = is_array($attributes[<span class="hljs-string">'CONSTRAINT'</span>])
							? <span class="hljs-string">'('</span>.implode(<span class="hljs-string">','</span>, $attributes[<span class="hljs-string">'CONSTRAINT'</span>]).<span class="hljs-string">')'</span>
							: <span class="hljs-string">'('</span>.$attributes[<span class="hljs-string">'CONSTRAINT'</span>].<span class="hljs-string">')'</span>;
						<span class="hljs-keyword">break</span>;
				}
			}

			$fields[] = $field;
		}

		<span class="hljs-keyword">return</span> $fields;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62"></a>
</div>
<div class="dox">
<div class="summary">
<p>Process column</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>$field
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>string
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_process_column</span><span class="hljs-params">($field)</span>
	</span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($field[<span class="hljs-string">'name'</span>])
			.<span class="hljs-string">' '</span>.$field[<span class="hljs-string">'type'</span>].$field[<span class="hljs-string">'length'</span>]
			.$field[<span class="hljs-string">'unsigned'</span>]
			.$field[<span class="hljs-string">'default'</span>]
			.$field[<span class="hljs-string">'null'</span>]
			.$field[<span class="hljs-string">'auto_increment'</span>]
			.$field[<span class="hljs-string">'unique'</span>];
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64"></a>
</div>
<div class="dox">
<div class="summary">
<p>Field attribute TYPE</p>
</div>
<div class="body">
<p>Performs a data type mapping between different databases.</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>&amp;$attributes
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>void
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_attr_type</span><span class="hljs-params">(&amp;$attributes)</span>
	</span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65"></a>
</div>
<p>Usually overridden by drivers</p>

        </td>
        <td class="code highlight">
          <pre class="php">	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67"></a>
</div>
<div class="dox">
<div class="summary">
<p>Field attribute UNSIGNED</p>
</div>
<div class="body">
<p>Depending on the _unsigned property value:</p>
<pre><code>- TRUE will always set $field['unsigned'] to 'UNSIGNED'
- FALSE will always set $field['unsigned'] to ''
- array(TYPE) will set $field['unsigned'] to 'UNSIGNED',
	if $attributes['TYPE'] is found in the array
- array(TYPE =&gt; UTYPE) will change $field['type'],
	from TYPE to UTYPE in case of a match</code></pre>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>&amp;$attributes
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>&amp;$field
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>void
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_attr_unsigned</span><span class="hljs-params">(&amp;$attributes, &amp;$field)</span>
	</span>{
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>($attributes[<span class="hljs-string">'UNSIGNED'</span>]) <span class="hljs-keyword">OR</span> $attributes[<span class="hljs-string">'UNSIGNED'</span>] !== <span class="hljs-keyword">TRUE</span>)
		{
			<span class="hljs-keyword">return</span>;
		}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68"></a>
</div>
<p>Reset the attribute in order to avoid issues if we do type conversion</p>

        </td>
        <td class="code highlight">
          <pre class="php">		$attributes[<span class="hljs-string">'UNSIGNED'</span>] = <span class="hljs-keyword">FALSE</span>;

		<span class="hljs-keyword">if</span> (is_array(<span class="hljs-keyword">$this</span>-&gt;_unsigned))
		{
			<span class="hljs-keyword">foreach</span> (array_keys(<span class="hljs-keyword">$this</span>-&gt;_unsigned) <span class="hljs-keyword">as</span> $key)
			{
				<span class="hljs-keyword">if</span> (is_int($key) &amp;&amp; strcasecmp($attributes[<span class="hljs-string">'TYPE'</span>], <span class="hljs-keyword">$this</span>-&gt;_unsigned[$key]) === <span class="hljs-number">0</span>)
				{
					$field[<span class="hljs-string">'unsigned'</span>] = <span class="hljs-string">' UNSIGNED'</span>;
					<span class="hljs-keyword">return</span>;
				}
				<span class="hljs-keyword">elseif</span> (is_string($key) &amp;&amp; strcasecmp($attributes[<span class="hljs-string">'TYPE'</span>], $key) === <span class="hljs-number">0</span>)
				{
					$field[<span class="hljs-string">'type'</span>] = $key;
					<span class="hljs-keyword">return</span>;
				}
			}

			<span class="hljs-keyword">return</span>;
		}

		$field[<span class="hljs-string">'unsigned'</span>] = (<span class="hljs-keyword">$this</span>-&gt;_unsigned === <span class="hljs-keyword">TRUE</span>) ? <span class="hljs-string">' UNSIGNED'</span> : <span class="hljs-string">''</span>;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-69" id="section-69"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-70" id="section-70"></a>
</div>
<div class="dox">
<div class="summary">
<p>Field attribute DEFAULT</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>&amp;$attributes
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>&amp;$field
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>void
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_attr_default</span><span class="hljs-params">(&amp;$attributes, &amp;$field)</span>
	</span>{
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;_default === <span class="hljs-keyword">FALSE</span>)
		{
			<span class="hljs-keyword">return</span>;
		}

		<span class="hljs-keyword">if</span> (array_key_exists(<span class="hljs-string">'DEFAULT'</span>, $attributes))
		{
			<span class="hljs-keyword">if</span> ($attributes[<span class="hljs-string">'DEFAULT'</span>] === <span class="hljs-keyword">NULL</span>)
			{
				$field[<span class="hljs-string">'default'</span>] = <span class="hljs-keyword">empty</span>(<span class="hljs-keyword">$this</span>-&gt;_null) ? <span class="hljs-string">''</span> : <span class="hljs-keyword">$this</span>-&gt;_default.<span class="hljs-keyword">$this</span>-&gt;_null;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-71" id="section-71"></a>
</div>
<p>Override the NULL attribute if that's our default</p>

        </td>
        <td class="code highlight">
          <pre class="php">				$attributes[<span class="hljs-string">'NULL'</span>] = <span class="hljs-keyword">TRUE</span>;
				$field[<span class="hljs-string">'null'</span>] = <span class="hljs-keyword">empty</span>(<span class="hljs-keyword">$this</span>-&gt;_null) ? <span class="hljs-string">''</span> : <span class="hljs-string">' '</span>.<span class="hljs-keyword">$this</span>-&gt;_null;
			}
			<span class="hljs-keyword">else</span>
			{
				$field[<span class="hljs-string">'default'</span>] = <span class="hljs-keyword">$this</span>-&gt;_default.<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape($attributes[<span class="hljs-string">'DEFAULT'</span>]);
			}
		}
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-72" id="section-72"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-73" id="section-73"></a>
</div>
<div class="dox">
<div class="summary">
<p>Field attribute UNIQUE</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>&amp;$attributes
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>&amp;$field
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>void
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_attr_unique</span><span class="hljs-params">(&amp;$attributes, &amp;$field)</span>
	</span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">empty</span>($attributes[<span class="hljs-string">'UNIQUE'</span>]) &amp;&amp; $attributes[<span class="hljs-string">'UNIQUE'</span>] === <span class="hljs-keyword">TRUE</span>)
		{
			$field[<span class="hljs-string">'unique'</span>] = <span class="hljs-string">' UNIQUE'</span>;
		}
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-74" id="section-74"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-75" id="section-75"></a>
</div>
<div class="dox">
<div class="summary">
<p>Field attribute AUTO_INCREMENT</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>&amp;$attributes
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span>&amp;$field
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>void
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_attr_auto_increment</span><span class="hljs-params">(&amp;$attributes, &amp;$field)</span>
	</span>{
		<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">empty</span>($attributes[<span class="hljs-string">'AUTO_INCREMENT'</span>]) &amp;&amp; $attributes[<span class="hljs-string">'AUTO_INCREMENT'</span>] === <span class="hljs-keyword">TRUE</span> &amp;&amp; stripos($field[<span class="hljs-string">'type'</span>], <span class="hljs-string">'int'</span>) !== <span class="hljs-keyword">FALSE</span>)
		{
			$field[<span class="hljs-string">'auto_increment'</span>] = <span class="hljs-string">' AUTO_INCREMENT'</span>;
		}
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-76" id="section-76"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-77" id="section-77"></a>
</div>
<div class="dox">
<div class="summary">
<p>Process primary keys</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table Table name
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>string
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_process_primary_keys</span><span class="hljs-params">($table)</span>
	</span>{
		$sql = <span class="hljs-string">''</span>;

		<span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>, $c = count(<span class="hljs-keyword">$this</span>-&gt;primary_keys); $i &lt; $c; $i++)
		{
			<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;fields[<span class="hljs-keyword">$this</span>-&gt;primary_keys[$i]]))
			{
				<span class="hljs-keyword">unset</span>(<span class="hljs-keyword">$this</span>-&gt;primary_keys[$i]);
			}
		}

		<span class="hljs-keyword">if</span> (count(<span class="hljs-keyword">$this</span>-&gt;primary_keys) &gt; <span class="hljs-number">0</span>)
		{
			$sql .= <span class="hljs-string">",\n\tCONSTRAINT "</span>.<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers(<span class="hljs-string">'pk_'</span>.$table)
				.<span class="hljs-string">' PRIMARY KEY('</span>.implode(<span class="hljs-string">', '</span>, <span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers(<span class="hljs-keyword">$this</span>-&gt;primary_keys)).<span class="hljs-string">')'</span>;
		}

		<span class="hljs-keyword">return</span> $sql;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-78" id="section-78"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-79" id="section-79"></a>
</div>
<div class="dox">
<div class="summary">
<p>Process indexes</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span>$table Table name
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>string[] list of SQL statements
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_process_indexes</span><span class="hljs-params">($table)</span>
	</span>{
		$sqls = <span class="hljs-keyword">array</span>();

		<span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>, $c = count(<span class="hljs-keyword">$this</span>-&gt;keys); $i &lt; $c; $i++)
		{
			<span class="hljs-keyword">if</span> (is_array(<span class="hljs-keyword">$this</span>-&gt;keys[$i]))
			{
				<span class="hljs-keyword">for</span> ($i2 = <span class="hljs-number">0</span>, $c2 = count(<span class="hljs-keyword">$this</span>-&gt;keys[$i]); $i2 &lt; $c2; $i2++)
				{
					<span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;fields[<span class="hljs-keyword">$this</span>-&gt;keys[$i][$i2]]))
					{
						<span class="hljs-keyword">unset</span>(<span class="hljs-keyword">$this</span>-&gt;keys[$i][$i2]);
						<span class="hljs-keyword">continue</span>;
					}
				}
			}
			<span class="hljs-keyword">elseif</span> ( ! <span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;fields[<span class="hljs-keyword">$this</span>-&gt;keys[$i]]))
			{
				<span class="hljs-keyword">unset</span>(<span class="hljs-keyword">$this</span>-&gt;keys[$i]);
				<span class="hljs-keyword">continue</span>;
			}

			is_array(<span class="hljs-keyword">$this</span>-&gt;keys[$i]) <span class="hljs-keyword">OR</span> <span class="hljs-keyword">$this</span>-&gt;keys[$i] = <span class="hljs-keyword">array</span>(<span class="hljs-keyword">$this</span>-&gt;keys[$i]);

			$sqls[] = <span class="hljs-string">'CREATE INDEX '</span>.<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($table.<span class="hljs-string">'_'</span>.implode(<span class="hljs-string">'_'</span>, <span class="hljs-keyword">$this</span>-&gt;keys[$i]))
				.<span class="hljs-string">' ON '</span>.<span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers($table)
				.<span class="hljs-string">' ('</span>.implode(<span class="hljs-string">', '</span>, <span class="hljs-keyword">$this</span>-&gt;db-&gt;escape_identifiers(<span class="hljs-keyword">$this</span>-&gt;keys[$i])).<span class="hljs-string">');'</span>;
		}

		<span class="hljs-keyword">return</span> $sqls;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-80" id="section-80"></a>
</div>
<hr>

        </td>
        <td class="code highlight">
          <pre class="php">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-81" id="section-81"></a>
</div>
<div class="dox">
<div class="summary">
<p>Reset</p>
</div>
<div class="body">
<p>Resets table creation vars</p>
</div>
<div class="details">
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span>void
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="php">	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_reset</span><span class="hljs-params">()</span>
	</span>{
		<span class="hljs-keyword">$this</span>-&gt;fields = <span class="hljs-keyword">$this</span>-&gt;keys = <span class="hljs-keyword">$this</span>-&gt;primary_keys = <span class="hljs-keyword">array</span>();
	}

}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
